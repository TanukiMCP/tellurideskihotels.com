---
interface Props {
  title?: string;
  description?: string;
  hotelId?: string;
  hotelName?: string;
  location?: string;
  filter?: string;
  variant?: 'default' | 'compact' | 'featured';
}

const { 
  title, 
  description, 
  hotelId, 
  hotelName, 
  location, 
  filter, 
  variant = 'default' 
} = Astro.props;

// Build the link based on props
function buildLink() {
  if (hotelId) {
    return `/places-to-stay/${hotelId}`;
  }
  
  const params = new URLSearchParams();
  if (location) params.set('location', location);
  if (filter) params.set('filter', filter);
  
  const queryString = params.toString();
  return queryString ? `/places-to-stay?${queryString}` : '/places-to-stay';
}

// Generate appropriate title based on context
function getTitle() {
  if (title) return title;
  if (hotelName) return `Book ${hotelName}`;
  if (filter) {
    const filterLabels: Record<string, string> = {
      'ski-in-ski-out': 'Ski-In/Ski-Out Lodging',
      'luxury': 'Luxury Accommodations',
      'budget': 'Budget-Friendly Options',
      'family-friendly': 'Family-Friendly Lodging',
    };
    return `Browse ${filterLabels[filter] || 'Places to Stay'}`;
  }
  if (location) {
    const locationLabels: Record<string, string> = {
      'mountain-village': 'Mountain Village Lodging',
      'downtown': 'Downtown Telluride Lodging',
    };
    return `Browse ${locationLabels[location] || 'Places to Stay'}`;
  }
  return 'Find Your Perfect Place to Stay in Telluride';
}

// Generate appropriate description
function getDescription() {
  if (description) return description;
  if (hotelName) return 'Check availability and compare rates from top booking sites';
  return 'Search and compare hundreds of properties with real-time availability';
}

// Generate appropriate CTA text
function getCtaText() {
  if (hotelName) return 'Check Availability & Rates';
  if (filter || location) return 'Browse Places to Stay';
  return 'Search Places to Stay';
}

const link = buildLink();
const widgetTitle = getTitle();
const widgetDescription = getDescription();
const ctaText = getCtaText();
---

{/* Compact variant */}
{variant === 'compact' && (
  <a
    href={link}
    class="block my-6 p-4 border-2 border-primary-200 rounded-lg bg-gradient-to-r from-primary-50 to-blue-50 hover:border-primary-400 hover:shadow-lg transition-all duration-300 group"
  >
    <div class="flex items-center justify-between gap-4">
      <div class="flex items-center gap-3">
        <div class="flex-shrink-0 w-10 h-10 bg-primary-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
          {hotelName ? (
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          ) : (
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
          )}
        </div>
        <div>
          <div class="font-semibold text-neutral-900 group-hover:text-primary-700 transition-colors">
            {widgetTitle}
          </div>
        </div>
      </div>
      <div class="flex-shrink-0">
        <div class="px-4 py-2 bg-primary-600 text-white rounded-md font-semibold group-hover:bg-primary-700 transition-colors">
          {hotelName ? 'View Rates →' : 'Search →'}
        </div>
      </div>
    </div>
  </a>
)}

{/* Featured variant */}
{variant === 'featured' && (
  <div class="my-8 border-2 border-primary-300 shadow-xl bg-gradient-to-br from-white via-primary-50 to-blue-50 rounded-xl overflow-hidden">
    <div class="p-8">
      <div class="flex flex-col md:flex-row gap-6 items-center">
        <div class="flex-shrink-0">
          <div class="w-20 h-20 bg-gradient-to-br from-primary-600 to-primary-700 rounded-2xl flex items-center justify-center shadow-lg">
            {hotelName ? (
              <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
            ) : (
              <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            )}
          </div>
        </div>
        <div class="flex-1 text-center md:text-left">
          <h3 class="text-2xl font-bold text-neutral-900 mb-2">
            {widgetTitle}
          </h3>
          <p class="text-neutral-700 text-lg mb-4">
            {widgetDescription}
          </p>
          <div class="flex flex-wrap gap-2 justify-center md:justify-start text-sm text-neutral-600">
            <div class="flex items-center gap-1">
              <svg class="w-4 h-4 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
              </svg>
              <span>Real-time pricing</span>
            </div>
            <span class="text-neutral-300">•</span>
            <div class="flex items-center gap-1">
              <svg class="w-4 h-4 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              <span>Instant confirmation</span>
            </div>
          </div>
        </div>
        <div class="flex-shrink-0">
          <a 
            href={link}
            class="inline-flex items-center justify-center bg-primary-600 hover:bg-primary-700 text-white font-bold px-8 py-4 text-lg shadow-lg hover:shadow-xl transition-all duration-300 rounded-lg"
          >
            {ctaText}
          </a>
        </div>
      </div>
    </div>
  </div>
)}

{/* Default variant */}
{variant === 'default' && (
  <div class="my-6 border-2 border-primary-200 hover:border-primary-400 hover:shadow-lg transition-all duration-300 bg-gradient-to-r from-white to-primary-50 rounded-xl overflow-hidden">
    <div class="p-6">
      <div class="flex flex-col sm:flex-row gap-4 items-start sm:items-center">
        <div class="flex-shrink-0">
          <div class="w-12 h-12 bg-primary-600 rounded-lg flex items-center justify-center">
            {hotelName ? (
              <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
            ) : (
              <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
              </svg>
            )}
          </div>
        </div>
        <div class="flex-1">
          <h3 class="text-lg font-bold text-neutral-900 mb-1">
            {widgetTitle}
          </h3>
          <p class="text-neutral-600 text-sm">
            {widgetDescription}
          </p>
        </div>
        <div class="flex-shrink-0 w-full sm:w-auto">
          <a
            href={link}
            class="inline-flex items-center justify-center w-full sm:w-auto bg-primary-600 hover:bg-primary-700 text-white font-semibold px-6 py-3 rounded-lg transition-colors"
          >
            {ctaText}
          </a>
        </div>
      </div>
    </div>
  </div>
)}

